b'\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef was relaxing outdoors after a poor performance during his university varsity\'s yearly week-long training retreat in the mountains. He was looking for a sign that he should continue competitive programming, even though at times, it can feel insurmountably difficult. Then, he looked up and saw a dazzling rainbow in the sky. He was so moved by the beauty of nature that he decided to continue programming and even created this problem about a mathematical Rainbow Road.\nLet the Rainbow Road be a grid with MM rows (numbered 11 through MM from top to bottom) and NN columns (numbered 11 through NN from left to right). Let\'s denote a cell in row ii and column jj by (i,j)(i,j), i.e. (1,1)(1,1) is the cell in the top left corner and (M,N)(M,N) is the cell in the bottom right corner. Chef selected NN distinct positive integers a1,a2,\xe2\x80\xa6,aNa1,a2,\xe2\x80\xa6,aN and instead of using colours, he "painted" stripes on the road with these numbers. For each valid jj, each cell in column jj has the same value ajaj.\nYou should answer QQ queries. In each query:\n\nYou are given an integer KK. Chef wants to travel from the cell (1,1)(1,1) to the cell (K,N)(K,N).\nIt is only possible to travel from any cell to the cell directly below it or to the cell directly to the right (if they exist). Formally, if Chef is in a cell (i,j)(i,j), he may only travel to (i+1,j)(i+1,j) or (i,j+1)(i,j+1).\nLet\'s define a path as a sequence of cells c1,c2,\xe2\x80\xa6,csc1,c2,\xe2\x80\xa6,cs such that for each ii (1\xe2\x89\xa4i<s1\xe2\x89\xa4i<s), Chef can travel from the cell cici to the cell ci+1ci+1.\nThe weight of a path is the product of the values of all cells in that path.\nChef wants you to find the sum of the weights of all possible paths that start in the cell (1,1)(1,1) and end in the cell (K,N)(K,N). Since this number can be quite large, compute it modulo 998,244,353=7\xe2\x8b\x8517\xe2\x8b\x85223+1998,244,353=7\xe2\x8b\x8517\xe2\x8b\x85223+1 (a prime number).\n\nInput\n\nThe first line of the input contains three space-separated integers MM, NN and QQ.\nThe second line contains NN space-separated integers a1,a2,\xe2\x80\xa6,aNa1,a2,\xe2\x80\xa6,aN.\nQQ lines follow. Each of these lines contains a single integer KK describing a query.\n\nOutput\nFor each query, print a single line containing one integer \xe2\x80\x95 the sum of weights of paths modulo 998,244,353998,244,353.\nConstraints\n\n1\xe2\x89\xa4M\xe2\x89\xa410181\xe2\x89\xa4M\xe2\x89\xa41018\n1\xe2\x89\xa4N\xe2\x89\xa41051\xe2\x89\xa4N\xe2\x89\xa4105 \n1\xe2\x89\xa4Q\xe2\x89\xa41051\xe2\x89\xa4Q\xe2\x89\xa4105\n1\xe2\x89\xa4ai<998,244,3531\xe2\x89\xa4ai<998,244,353 for each valid ii\na1,a2,\xe2\x80\xa6,aNa1,a2,\xe2\x80\xa6,aN are pairwise distinct\n1\xe2\x89\xa4K\xe2\x89\xa4M1\xe2\x89\xa4K\xe2\x89\xa4M\n\nSubtasks\nSubtask 1 (10 points): M,N\xe2\x89\xa42,000M,N\xe2\x89\xa42,000\nSubtask 2 (25 points): M\xe2\x89\xa4105M\xe2\x89\xa4105\nSubtask 3 (15 points):\n\nQ\xe2\x89\xa410Q\xe2\x89\xa410\nN\xe2\x89\xa42,000N\xe2\x89\xa42,000\n\nSubtask 4 (50 points): Q\xe2\x89\xa410Q\xe2\x89\xa410\nExample Input 1\n2 3 2\n1 3 5\n1\n2\n\nExample Output 1\n15\n135\n\nExplanation\nIn the first query, there is only one path from (1,1)(1,1) to (1,3)(1,3): (1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)(1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3). This path has weight 1\xe2\x8b\x853\xe2\x8b\x855=151\xe2\x8b\x853\xe2\x8b\x855=15.\nIn the second query, there are three paths from (1,1)(1,1) to (2,3)(2,3):\n\n(1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)\xe2\x86\x92(2,3)(1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(1,3)\xe2\x86\x92(2,3) with weight 1\xe2\x8b\x853\xe2\x8b\x855\xe2\x8b\x855=751\xe2\x8b\x853\xe2\x8b\x855\xe2\x8b\x855=75.\n(1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3)(1,1)\xe2\x86\x92(1,2)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3) with weight 1\xe2\x8b\x853\xe2\x8b\x853\xe2\x8b\x855=451\xe2\x8b\x853\xe2\x8b\x853\xe2\x8b\x855=45.\n(1,1)\xe2\x86\x92(2,1)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3)(1,1)\xe2\x86\x92(2,1)\xe2\x86\x92(2,2)\xe2\x86\x92(2,3) with weight 1\xe2\x8b\x851\xe2\x8b\x853\xe2\x8b\x855=151\xe2\x8b\x851\xe2\x8b\x853\xe2\x8b\x855=15.\n\nExample Input 2\n5 2 5\n1 2\n1\n2\n3\n4\n5\n\nExample Output 2\n2\n6\n14\n30\n62\n\nExplanation\nIn the last query, there are five paths from (1,1)(1,1) to (5,2)(5,2). Their weights are 22, 44, 88, 1616 and 3232, which sum up to 6262.\nExample Input 3\n3 3 3\n215 228 229\n1\n2\n3\n\nExample Output 3\n11225580\n555879289\n157593602\n\n\n\n\nAuthor:\n3\xe2\x98\x85shisuko\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/RNBWROAD\n\n\nTags:\n\n               \n                 Number Theory, Generating Functions, FFT\n                 \n                     \n                     Mathematics, Sequences and Progression, Transformations\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2749\n\n\nDate Added:\n29-03-2020\n\n\nTime Limit:\n7 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n'