b"\nRead problem statements in Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef wants to study reactions between non-miscible reagent samples with different colours. There are NN colours (numbered 11 through NN). Chef has N+2N+2 test tubes (numbered 11 through N+2N+2), each of them can hold a volume MM ml; initially, tubes N+1N+1 and N+2N+2 are empty, while for each ii (1\xe2\x89\xa4i\xe2\x89\xa4N1\xe2\x89\xa4i\xe2\x89\xa4N), the ii-th tube is completely filled and contains MM ml of reagents with some colours. Since reagents with different colours do not mix, we can describe the contents of the ii-th tube from its bottom to its top by a sequence Bi,1,Bi,2,\xe2\x80\xa6,Bi,MBi,1,Bi,2,\xe2\x80\xa6,Bi,M, i.e. for each valid jj, the jj-th mililiter of volume of the ii-th tube, measured from the bottom, is filled by a reagent with a colour Bi,jBi,j. The total initial volume of each reagent is equal to MM ml.\nTo facilitate his study, Chef wants to redistribute the reagents into tubes according to their colours, i.e. at the end, for each colour ii, there must be exactly one tube which contains all MM ml of this reagent and no reagents with other colours. The specific positions of reagents or empty tubes in this final state do not matter.\nIn order to achieve this, you may first reverse the order of reagents in some (possibly none or all) tubes. Then, you may perform operations of two types:\n\nChoose two test tubes PP and QQ and transfer the topmost 11 ml of reagent from the tube PP to the top of the tube QQ.\nThis is only allowed if PP is non-empty and QQ is not full.\nIf QQ is empty, the cost of this operation is 00.\nOtherwise, let's denote the colour of the topmost reagent in tube PP by UU and the colour of the topmost reagent in QQ (before this operation) by VV. If DU,V=\xe2\x88\x921DU,V=\xe2\x88\x921, this operation is not allowed. Otherwise, it is allowed and its cost is DU,VDU,V.\nChoose a test tube PP and increase its capacity by 11 ml. The cost of this operation is CPCP.\n\nYou are given the costs of pouring reagents on top of each other and information about which reagents react with each other and therefore cannot be poured on top of each other, i.e. the matrix DD. It is guaranteed that Di,j=Dj,iDi,j=Dj,i for each valid ii and jj and Di,i=0Di,i=0 for each valid ii.\nYou must separate the reagents (reach the state described above) using no more than 220=1,048,576220=1,048,576 operations. The sum of costs of the operations you use to achieve this should be as small as possible.\nInput\n\nThe first line of the input contains two space-separated integers NN and MM.\nThe second line contains N+2N+2 space-separated integers C1,C2,\xe2\x80\xa6,CN+2C1,C2,\xe2\x80\xa6,CN+2.\nNN lines follow. For each valid ii, the ii-th of these lines contains NN space-separated integers Di,1,Di,2,\xe2\x80\xa6,Di,NDi,1,Di,2,\xe2\x80\xa6,Di,N.\nNN more lines follow. For each valid ii, the ii-th of these lines contains MM space-separated integers Bi,1,Bi,2,\xe2\x80\xa6,Bi,MBi,1,Bi,2,\xe2\x80\xa6,Bi,M.\n\nOutput\n\nFirst, print a single line containing two space-separated integers XX and YY (0\xe2\x89\xa4X\xe2\x89\xa4N0\xe2\x89\xa4X\xe2\x89\xa4N, 0\xe2\x89\xa4Y\xe2\x89\xa42200\xe2\x89\xa4Y\xe2\x89\xa4220) \xe2\x80\x95 the number of test tubes whose contents you wish to initially reverse and the number of operations you wish to perform.\nThen, print a single line containing XX space-separated integers A1,A2,\xe2\x80\xa6,AXA1,A2,\xe2\x80\xa6,AX \xe2\x80\x95 the numbers of the test tubes you wish to initially reverse (1\xe2\x89\xa4Ai\xe2\x89\xa4N1\xe2\x89\xa4Ai\xe2\x89\xa4N for each valid ii).\nThen, print YY lines describing the operations in the order in which you wish to perform them.\nTo perform an operation of the first type, print a line containing three space-separated integers 11, PP and QQ (1\xe2\x89\xa4P,Q\xe2\x89\xa4N+21\xe2\x89\xa4P,Q\xe2\x89\xa4N+2, P\xe2\x89\xa0QP\xe2\x89\xa0Q).\nTo perform an operation of the second type, print a line containing two space-separated integers 22 and PP (1\xe2\x89\xa4P\xe2\x89\xa4N+21\xe2\x89\xa4P\xe2\x89\xa4N+2).\n\nConstraints\n\nN=512N=512\nM=16M=16\n1\xe2\x89\xa4Ci\xe2\x89\xa41,0001\xe2\x89\xa4Ci\xe2\x89\xa41,000 for each valid ii\n\xe2\x88\x921\xe2\x89\xa4Di,j\xe2\x89\xa4100\xe2\x88\x921\xe2\x89\xa4Di,j\xe2\x89\xa4100 for each valid i,ji,j\nDi,j=Dj,iDi,j=Dj,i for each valid i,ji,j\nDi,i=0Di,i=0 for each valid ii\n1\xe2\x89\xa4Bi,j\xe2\x89\xa4N1\xe2\x89\xa4Bi,j\xe2\x89\xa4N for each valid i,ji,j\n\nExample Input\n4 4\n3 5 2 3 1 4\n0 -1 2 -1\n-1 0 1 7\n2 1 0 -1\n-1 7 -1 0\n1 2 1 3\n3 3 2 2\n4 1 3 4\n1 2 4 4\n\nExample Output\n2 19\n1 3\n1 4 5\n1 4 5\n1 3 5\n1 2 4\n1 2 4\n1 1 2\n2 4\n1 1 4\n1 2 6\n1 3 6\n1 1 6\n1 1 2\n1 3 2\n1 4 1\n1 4 1\n1 4 1\n1 4 1\n1 4 6\n1 3 5\n\nExplanation\nThe initial arrangement of reagents in test tubes is\n\nAfter reversing the contents of the 11-st and 33-rd test tube, the arrangement becomes\n\nAfter the first 66 operations, the arrangement becomes\n\nAfter the first 88 operations:\n\nAfter the first 1313 operations:\n\nAfter all 1919 operations, the reagents get separated:\n\nThe cost paid for the 66-th operation is 22 and the cost paid for the 77-th operation is 33. The cost paid for all other operations is 00. Thus, the reagents are separated with a total cost 55. Note that this is not necessarily an optimal way to separate the reagents.\nIn the actual test data, NN is 512512 and MM is 1616. Smaller values have been used in this example for clarity.\nTest Generation\nThe generator used to generate the test cases can be found here.\n\nN=512N=512\nM=16M=16\nInitially, for each ii (1\xe2\x89\xa4i\xe2\x89\xa4N1\xe2\x89\xa4i\xe2\x89\xa4N), the ii-th test tube is completely filled with MM ml of the reagent with colour ii.\nA parameter G\xe2\x88\x88{4096,16384,65536,1048576}G\xe2\x88\x88{4096,16384,65536,1048576} is chosen and the following operation is performed GG times: two different test tubes EE and FF such that EE is not empty are chosen randomly and 11 ml of reagent is transferred from top of EE to FF. We consider the capacities of the tubes to be infinite here.\nThen, for each test tube that contains more than MM ml of reagents, the volume of reagents in it is decreased to MM by transferring excess reagents (in whole mililiters) from the top into tubes that contain less than MM ml of reagents randomly.\nThen, the test tubes N+1N+1 and N+2N+2 are made empty by transferring their contents randomly to other test tubes that contain less than MM ml of reagents.\nThe values of C1,C2,\xe2\x80\xa6,CN+2C1,C2,\xe2\x80\xa6,CN+2 are chosen uniformly randomly and independently between 11 and 10001000 inclusive.\nThen, another parameter K\xe2\x88\x88{1,4,16,64}K\xe2\x88\x88{1,4,16,64} is chosen.\nFinally, N(N\xe2\x88\x921)2KN(N\xe2\x88\x921)2K distinct unordered pairs of distinct colours are chosen randomly. For each of these pairs (U,V)(U,V) (1\xe2\x89\xa4U<V\xe2\x89\xa4N1\xe2\x89\xa4U<V\xe2\x89\xa4N), DU,V=DV,UDU,V=DV,U is chosen uniformly randomly and independently between 11 and 100100 inclusive. For all other such pairs, DU,V=DV,U=\xe2\x88\x921DU,V=DV,U=\xe2\x88\x921.\n\nThere are 1616 test files corresponding to all possible combinations of parameters GG and KK.\nScoring\nThe checker used to determine the score of your submission can be found here.\nIf you perform an invalid operation or the reagents are not separated after all the operations (particularly, if there is a test tube which contains reagents with more than one colour or there is a colour which appears in more than one test tube), then you will receive the Wrong Answer verdict.\nOtherwise, the score for a test file is the total cost of all the operations. The score of a submission is the sum of scores of all test files. Your goal is to minimise this score.\nThere are 16 test files. During the contest, the displayed score will account for exactly 8 test files, i.e. your score reflects your submission's performance on 50% (8/16) of the test files. However, if your program gets a non-AC verdict on any test file, your submission's verdict will be non-AC. In other words, an AC verdict denotes that your program runs successfully on all the test files. After the end of the contest, your score will be changed to include the sum of your program's scores over the other 8 test files.\n\n\n\nAuthor:\n6\xe2\x98\x85jay_1048576\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/WTRSORT\n\n\nTags:\n\n               \n                 april21, greedy, heuristic, implementation, jay_1048576, tie-breaker\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3758\n\n\nDate Added:\n23-03-2021\n\n\nTime Limit:\n5 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"