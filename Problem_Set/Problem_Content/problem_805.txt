b"\n Read problems statements in Mandarin Chinese, Russian and Vietnamese as well.\nChef made a hedge maze on his rectangular garden. It is rectangular in shape with dimensions R \xc3\x97 C, where R is the number of rows and C is the number of columns, both in meters, when viewed from the top. It is divided into a grid with R * C individual cells, each of size (1 meter) \xc3\x97 (1 meter), and each cell is identified by two integers (i, j) denoting the row and column number of the cell, respectively (1 \xe2\x89\xa4 i \xe2\x89\xa4 R and 1 \xe2\x89\xa4 j \xe2\x89\xa4 C).\nYou can usually go from any cell to any of its four adjacent cells. However, vertical hedges exist between some pairs of cells, preventing direct movement between them. Also, the maze has the property that there is a unique path between every two cells.\nChef is currently at cell (i1, j1) and wants to go to cell (i2, j2). Chef recently learned about a maze solving algorithm called the right-hand rule. In this algorithm, Chef first picks one of the four directions to go to, and then proceeds in that direction while keeping his right hand in contact with the wall at all times. This simple algorithm guarantees that Chef will reach any other cell of the maze!\nThe following image illustrates this algorithm a few times:\n\nUnfortunately, as you can see, this doesn't guarantee that Chef visits the minimum number of cells required! So your goal here is to answer Q queries of the following kind: For a given pair of starting and ending cells (i1, j1) and (i2, j2) and an initial direction U (up), D (down), L (left) or R (right), determine the number of cells Chef visits if he follows the right-hand rule.\nNotes:\n\nIf there is no wall to the right initially, start the traversal by placing the right-hand on the nearest wall in front and to the right of you. The image illustrates it.\nThe right hand only serves as a guide on where to go next. You still face in the direction you're walking.\n\nInput\nThe first line of the input contains three space-separated integers R, C and Q.\nThe next 2R+1 lines describe the maze. Each line consists of a string of 2C+1 characters. Here's how to interpret them:\n\nFor ease of input, blank characters are written as a . (dot).\nThe 2jth character in the 2ith row represents cell (i, j), and is guaranteed to be blank.\nBetween adjacent cells in the same row, the character | indicates that there is a vertical hedge between them.\nBetween adjacent cells in the same column, the character - indicates that there is a vertical hedge between them.\nA blank character between adjacent cells means that there is no vertical hedge between them.\nThe characters at the boundary represents the boundary hedges of the maze. It is guaranteed that there's no way out of the maze.\nThe + character represents corners of the cells.\n\nThe Q lines following the maze represents the queries. Each query contains four integers and a character, separated by single-spaces: i1, j1, i2, j2, dir, representing the starting and ending cells and the initial direction.\nOutput\nFor each query, output a single line containing an integer, the number of cells Chef visits if he follows the right-hand rule.\nConstraints\n\n1 \xe2\x89\xa4 R, C \xe2\x89\xa4 105\n1 \xe2\x89\xa4 Q \xe2\x89\xa4 105\n1 \xe2\x89\xa4 R\xc3\x97C \xe2\x89\xa4 5\xc3\x97105\n1 \xe2\x89\xa4 i1, i2 \xe2\x89\xa4 R\n1 \xe2\x89\xa4 j1, j2 \xe2\x89\xa4 C\ndir is one of: U, D, L or R\n(i1, j1) \xe2\x89\xa0 (i2, j2)\nThere is a unique path between any two cells.\n\nExample\nInput:\n6 7 10\n+-+-+-+-+-+-+-+\n|.|.....|.....|\n+.+-+.+-+.+-+.+\n|...|.|.|...|.|\n+-+.+.+.+-+.+-+\n|.........|...|\n+.+.+.+.+-+.+.+\n|.|.|.|.|...|.|\n+-+.+-+.+.+-+.+\n|...|...|...|.|\n+.+.+.+-+-+-+.+\n|.|.|.........|\n+-+-+-+-+-+-+-+\n3 4 2 7 D\n3 2 3 4 R\n3 2 3 4 D\n3 2 3 4 L\n3 2 3 4 U\n1 4 2 4 R\n1 4 2 4 D\n1 4 2 4 L\n1 4 2 4 U\n2 3 2 4 R\n\nOutput:\n19\n4\n9\n11\n14\n42\n42\n42\n42\n42\n\n\nExplanation\nThe sample input represents the maze in the image above, and the answer to the first and third queries are also illustrated in the image.\n\n\n\nAuthor:\n7\xe2\x98\x85kevinsogo\n\n\nTester:\n\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/MAZETRAV\n\n\nTags:\n\n               \n                 dynamic-programming, kevinsogo, lowest-common-ancestor, medium-hard, snckel16\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\nN/A\n\n\nDate Added:\n7-06-2016\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"