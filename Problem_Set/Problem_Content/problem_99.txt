b"\n Read problems statements in Mandarin Chinese, Russian and Vietnamese as well.\nChef is working as a programmer. His job schedule is very interesting: he rests for R0 minutes, works for some time, then rests for R1 minutes, then works some more, and so on. \nBy the way, Chef has M books he wants to read. Each book has some given number of pages, and Chef reads one page per minute independent of which page of whichever book it is. Chef has two types of books to read: the first type are too interesting for an interrupted read and, therefore, need to be finished in one continuous reading session, that is, some ith resting period or a part of it. Books of the second type are more casual reads which can be split up in any way between different resting periods (read a few pages, then read another book or do the job, and continue later). \nChef is getting tired when switch, that is why each book can be read for some times only once per rest. \nLet us take an example: If Chef has a rest period array R = {4,1,1}, and books types to read: (1st, 3 min), (2nd, 3 min). Chef can finish the first book in the first rest period (minutes from 1st to 3rd), and use the 4th minute of first period, along with the second and third periods to finish the second book.\n\nSome books are part of a series, and need to be read in order. In other words, some books can't be started until some other books are done. You are given this information in the form of pairwise dependencies, indicating that one book cannot be started before the other is finished. Chef promises that there are no cycles across these directed dependencies.\nEach book has a rating, expressed as a positive integer. When Chef finishes a book, his happiness increases by this number.\n\nScoring\n\nFor each test, your result will be defined as the sum of ratings of books you finish.\nThe total score for a submission is the sum of the scores for all test cases.\nYour task is to maximize the total score.\n\nInput\n\nThe first line of each test case contains three integers \xe2\x80\x94 N denoting the number of rest periods, M denoting the number of books, and K denoting the number of dependencies. The second line contains N space-separated integers R1, R2, \xe2\x80\xa6, RN denoting the duration of each period.\nNext M lines describe the books, with the ith line describing the ith book. Each line contains tree integers Ti, Pi and Wi. Ti is the type of the ith book. Pi is the number of pages in it. Wi is the rating of the book.\nNext K lines describe the inter-book dependencies. Each line contains two integers \xe2\x80\x94 A and B \xe2\x80\x94 denoting that book A should be finished before book B can be started. The books are indexed in the order of their description in the input.\n\nOutput\n\nFor each rest period, output a single line. The first integer in the line must be K', the number of books you read (fully or partially) in this period. Follow this up with two integers for each book: I \xe2\x80\x94 the index of the book you chose (books are enumerated from 1 to M as they are given in input) and W' \xe2\x80\x94 the number of minutes you spent on it.\nYou are not allowed two print one book twice in one line. \nYou can't read the book if it is already finished. Sum of all W' in a line should not be bigger than the rest period duration.\nIf you do nothing in a rest period, just print 0.\nAny book of the first type should occur at most once in the output. If Chef reads such a book, it should be done completely in one segment.\nChef can't start book B until he finishes book A if there is a dependency A, B in the input.\n\nConstraints\n\n1 \xe2\x89\xa4 N  \xe2\x89\xa4 5*104\n1 \xe2\x89\xa4  M, K \xe2\x89\xa4 105\n20 \xe2\x89\xa4 Ri\xe2\x89\xa4 200\n10 \xe2\x89\xa4 Pi\xe2\x89\xa4 160\n1 \xe2\x89\xa4 Ti \xe2\x89\xa4 2\n5 \xe2\x89\xa4 Wi \xe2\x89\xa4 1600\n1 \xe2\x89\xa4 A, B \xe2\x89\xa4 M\n\nExample\nInput:\n3 8 2\n10 10 10\n1 8 2\n1 7 1\n2 5 4\n2 4 1\n2 3 1\n2 3 4\n2 6 1\n1 5 1\n1 3\n3 2\n\nOutput:\n2 1 8 3 2\n2 3 3 2 7\n3 4 4 5 3 6 3\n\n Test generation plan\n\nSum of Ri's will be rand(5 * 105, 106).\nSum of Pi's will be rand(3 * sum of R's, 8 * sum of R's).\nLet Rmin and Rmax denote the minimum and maximum values of Ri, respectively.\nRmin will be rand(20, 100). \nRmax will be rand(Rmin + 50, 200). \nWe will generate the number of pages of the books in an incremental fashion such that number of pages in a book will be rand(Rmin / 2, Rmax* 4 / 5).\n\n\nThere are total 4 types of test files, whose description is given below. Please note that the total number of books of type 2 in each test case will be rand(10, 20), unless stated otherwise.\n\nType 1 : We will generate a directed acyclic graph (DAG) encoding the dependencies of books. Each connected component of the DAG has rand(10, 50) vertices. The rating of a book depends on the number of pages in it and the minimum number of books that need to be finished before starting that particular book. The ratio of weight / number of pages will be in the range [1, 10] for books of the first type and [0.5, 1] for that of second type.\nType 2 : The DAG generator will be same as above. Rating of each book is computed as rand(20,500).\nType 3 : Same as Type 1, but with no books of the second type.\nType 4 : Same as Type 1, except that the underlying DAG will be a collections of paths.\n\n\n\nWe have 20 test files, 5 for each type. During the contest, your solution will run on all the test files. If your program gives WA/TLE/RE on any of the test files out of 20, it will be reported to you. On the other hand, if you get an AC, then the score reported to you is not the total score for all the files; instead, it is only the score for 4 test files, one of each type.\n            \n            \n            \n            \n            \n        \n\n        \n\n\nAuthor:\nberezin\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/CHEFJR\n\n\nTags:\n\n               \n                 berezin, challenge, feb16, greedy\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n3658\n\n\nDate Added:\n14-09-2014\n\n\nTime Limit:\n3 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nPYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, PERL, SCALA, LUA, BASH, JS, LISP sbcl, PAS gpc, BF, CLOJ, D, CAML, FORT, ASM, FS, WSPC, LISP clisp, SCM guile, PERL6, ERL, CLPS, PRLG, ICK, NICE, ICON, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"